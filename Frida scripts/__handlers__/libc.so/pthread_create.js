/*
 * Auto-generated by Frida. Please modify to match the signature of pthread_create.
 * This stub is currently auto-generated from manpages when available.
 *
 * For full API reference, see: https://frida.re/docs/javascript-api/
 */

defineHandler({
  onEnter(log, args, state) {
    log(`pthread_create(thread=${args[0]}, attr=${args[1]}, start_routine=${args[2]})`);
    try {
      try {
        Java.perform(function () {
          try {
            var Thread = Java.use('java.lang.Thread');
            var cur = Thread.currentThread();
            var st = cur.getStackTrace();
            var javaFrames = [];
            for (var i = 0; i < st.length; i++) {
              try { javaFrames.push(st[i].toString()); } catch (ee) {}
            }
            if (javaFrames.length > 0) {
              log("JAVA STACK")
              for(let i = 0;i<javaFrames.length;i++){
                    log((i+1)+") "+javaFrames[i])
              }
              log("\n");
            }
          } catch (je) {
            
          }
        });
      } catch (e) {
        
      }
    } catch (err) {
      log('handler error: ' + err);
    }
  },

  onLeave(log, retval, state) {
  }
});
